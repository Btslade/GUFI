get exernal drive
plug it in
do diskutil list to see that it is disk3  /dev/disk3
do diskutil erasedisk HFS+ z3 GPT /dev/disk3   that erases the disk and sets it up to be partitioned
run diskutil interactively go into disk3 and click on the pie chart and click add and add to get 3 partitions
click on each one and give it a name, make it be a HFS+  - it will make three paritions
I made 3 partinions z1 z2 and z3 each 667 GB
z1 /dev/disk3s4 z2 /dev/disk3s3 z3 /dev/disk3s2
plan to mirror z1 and z2 as a zpool and use z3 as a snapshot

to become root to set up zpools etc.
su - L106273
password
su sh
presto you are root

zfs stuff once root
go to finder and eject z1 and z2
then
zpool create -f -o ashift=12 -O casesensitivity=insensitive -O normalization=formD myzpool1 mirror /dev/disk3s4 /dev/disk3s3
that made a myzpool1 out of z1 and z2

set compresson on
zfs set compression=lz4 myzpool1

Unplugging a pool
The equivalent of unmounting a device before unplugging it is exporting a pool in ZFS terminology.
Before unplugging any devices you must export all pools using the device.
sudo zpool export $poolname
The export can sometimes fail if the mount is busy (as with all filesystems). So you might need to close any applications still accessing the pool. Also, there is an option "-f" to force unmount while exporting:
sudo zpool export -f $poolname
If you are just rebooting, you do not need to export first. 

zpool import myzpool1

$ sudo zfs mount WD_1TB
cannot open 'WD_1TB': pool I/O is currently suspended
cannot open 'WD_1TB': pool I/O is currently suspended

$ sudo zfs unmount WD_1TB
cannot open 'WD_1TB': pool I/O is currently suspended
cannot open 'WD_1TB': pool I/O is currently suspended

$ sudo zpool destroy -f WD_1TB
cannot open 'WD_1TB': pool I/O is currently suspended

$ zpool export WD_1TB
(hanging)

$ sudo zpool clear WD_1TB
cannot clear errors for WD_1TB: I/O error


add "flag files" to each file system to prevent various OS X services from dirtying them. E.g. touch /tank/.metadata_never_index should prevent Spotlight indexing. We should collect a list here of all the rules for preventing such "dirty" services. 

sh-3.2# umount /Volumes/myzpool1/
umount(/Volumes/myzpool1): Resource busy -- try 'diskutil unmount'
sh-3.2# umount -f /Volumes/myzpool1/
sh-3.2# zpool export myzpool1

zfs diff -H tank@lastsnap tank
